<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo App</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #e0e7ff;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        padding: 20px;
      }
      .todo-container {
        background-color: #f8fafc;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 500px;
      }
      h1 {
        text-align: center;
        color: #1f2937;
        margin-bottom: 20px;
      }
      .input-section {
        margin-bottom: 20px;
      }
      .input-group {
        display: flex;
        width: 100%;
        gap: 20px;
      }
      #todoInput {
        flex: 1;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #d1d5db;
        border-radius: 5px;
      }
      button {
        padding: 10px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        background-color: #3b82f6;
        color: #ffffff;
      }
      button:hover {
        background-color: #2563eb;
      }
      .filter-section {
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
      }
      .filter-section button {
        background-color: #e5e7eb;
        color: #1f2937;
      }
      .filter-section button:hover {
        background-color: #d1d5db;
      }
      .filter-section button.active {
        background-color: #3b82f6;
        color: #ffffff;
      }
      .todo-list {
        list-style: none;
        padding: 0;
      }
      .todo-item {
        display: flex;
        align-items: center;
        padding: 10px;
        background-color: #ffffff;
        margin-bottom: 10px;
        border-radius: 5px;
        border: 1px solid #d1d5db;
      }
      .todo-item.completed span.task-text {
        text-decoration: line-through;
        color: #6b7280;
      }
      .todo-item span.task-text {
        flex: 1;
        font-size: 16px;
        color: #1f2937;
      }
      .todo-item .status {
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 14px;
        margin-right: 10px;
        cursor: pointer;
        user-select: none;
      }
      .todo-item .status.completed {
        background-color: #10b981;
        color: #ffffff;
      }
      .todo-item .status.active {
        background-color: #f59e0b;
        color: #ffffff;
      }
      .todo-item button {
        margin-left: 10px;
      }
      .todo-item button.delete {
        background-color: #ef4444;
      }
      .todo-item button.delete:hover {
        background-color: #dc2626;
      }
      .todo-item button.edit {
        background-color: #8b5cf6;
      }
      .todo-item button.edit:hover {
        background-color: #7c3aed;
      }
      .error-message {
        color: #dc2626;
        font-size: 14px;
        margin-top: 5px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="todo-container">
      <h1>Danh Sách Công Việc</h1>
      <div class="input-section">
        <div class="input-group">
          <input
            type="text"
            id="todoInput"
            placeholder="Nhập công việc mới..."
          />
          <button id="actionButton" onclick="addTodo()">Thêm</button>
        </div>
        <div id="errorMessage" class="error-message">
          Vui lòng nhập công việc!
        </div>
      </div>
      <div class="filter-section">
        <button onclick="filterTodos('all')" class="active">Tất cả</button>
        <button onclick="filterTodos('active')">Chưa hoàn thành</button>
        <button onclick="filterTodos('completed')">Hoàn thành</button>
      </div>
      <ul class="todo-list" id="todoList"></ul>
    </div>

    <script>
      let todos = JSON.parse(localStorage.getItem("todos")) || [];
      let currentFilter = "all";
      let editingIndex = null;

      const todoInput = document.getElementById("todoInput");
      const todoList = document.getElementById("todoList");
      const errorMessage = document.getElementById("errorMessage");
      const actionButton = document.getElementById("actionButton");

      function saveTodos() {
        localStorage.setItem("todos", JSON.stringify(todos));
      }

      function renderTodos() {
        todoList.innerHTML = "";

        const filtered = todos.filter((todo) => {
          if (currentFilter === "active") return !todo.completed;
          if (currentFilter === "completed") return todo.completed;
          return true;
        });

        filtered.forEach((todo, index) => {
          const li = document.createElement("li");
          li.className = `todo-item ${todo.completed ? "completed" : ""}`;

          const taskSpan = document.createElement("span");
          taskSpan.className = "task-text";
          taskSpan.innerText = todo.text;
          taskSpan.onclick = () => toggleComplete(index);

          const status = document.createElement("div");
          status.className = `status ${
            todo.completed ? "completed" : "active"
          }`;
          status.innerText = todo.completed ? "Hoàn thành" : "Chưa hoàn thành";
          status.onclick = () => toggleComplete(index);

          const editBtn = document.createElement("button");
          editBtn.className = "edit";
          editBtn.innerText = "Sửa";
          editBtn.onclick = () => editTodo(index);

          const deleteBtn = document.createElement("button");
          deleteBtn.className = "delete";
          deleteBtn.innerText = "Xoá";
          deleteBtn.onclick = () => deleteTodo(index);

          li.appendChild(status);
          li.appendChild(taskSpan);
          li.appendChild(editBtn);
          li.appendChild(deleteBtn);
          todoList.appendChild(li);
        });
      }

      function addTodo() {
        const text = todoInput.value.trim();
        if (text === "") {
          errorMessage.style.display = "block";
          return;
        }

        errorMessage.style.display = "none";

        if (editingIndex !== null) {
          todos[editingIndex].text = text;
          editingIndex = null;
          actionButton.innerText = "Thêm";
        } else {
          todos.push({ text, completed: false });
        }

        todoInput.value = "";
        saveTodos();
        renderTodos();
      }

      function editTodo(index) {
        todoInput.value = todos[index].text;
        editingIndex = index;
        actionButton.innerText = "Cập nhật";
      }

      function deleteTodo(index) {
        todos.splice(index, 1);
        saveTodos();
        renderTodos();
      }

      function toggleComplete(index) {
        todos[index].completed = !todos[index].completed;
        saveTodos();
        renderTodos();
      }

      function filterTodos(status) {
        currentFilter = status;
        document.querySelectorAll(".filter-section button").forEach((btn) => {
          btn.classList.remove("active");
        });
        const activeBtn = Array.from(
          document.querySelectorAll(".filter-section button")
        ).find((btn) =>
          btn.textContent.includes(
            status === "all" ? "Tất cả" : status === "active" ? "Chưa" : "Hoàn"
          )
        );
        if (activeBtn) activeBtn.classList.add("active");
        renderTodos();
      }

      renderTodos();
    </script>
  </body>
</html>
